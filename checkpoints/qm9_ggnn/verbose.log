Fold 0
{'activation': 'ReLU',
 'atom_messages': True,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': True,
 'data_path': 'data/qm9.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': 0,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': True,
 'save_dir': 'checkpoints/qm9_ggnn/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'scaffold_balanced',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 12
Splitting data with seed 0
Total scaffolds = 15,989 | train scaffolds = 13,406 | val scaffolds = 1,626 | test scaffolds = 957
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([ 3.06770674e+00,  7.52033183e+01, -2.55926597e-01, -5.90761537e-03,
        2.50018624e-01,  1.52537269e+03,  1.51277474e-01,  3.52361516e+01,
       -4.16967530e+02, -4.16957378e+02, -4.16956434e+02, -4.17003691e+02]), array([13998, 13998, 13998, 13998, 13998, 13998, 13998, 13998, 13998,
       13998, 13998, 13998])), (array([ 2.33190000e+00,  7.53500000e+01, -2.14400000e-01, -1.70000000e-02,
        1.97400000e-01,  1.10743790e+03,  1.62372000e-01,  3.06960000e+01,
       -4.19191774e+02, -4.19183938e+02, -4.19182994e+02, -4.19224242e+02]), array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])), (array([ 1.18850000e+00,  6.82200000e+01, -2.56400000e-01, -1.67000000e-02,
        2.39700000e-01,  1.11738480e+03,  1.24501000e-01,  2.86110000e+01,
       -4.74958657e+02, -4.74951049e+02, -4.74950105e+02, -4.74991316e+02]), array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])), (array([ 5.00000000e-04,  8.44500000e+01, -2.18100000e-01,  8.30000000e-03,
        2.26400000e-01,  1.05648860e+03,  1.60839000e-01,  2.87300000e+01,
       -3.48675405e+02, -3.48668704e+02, -3.48667760e+02, -3.48706071e+02]), array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])), (array([ 4.80930000e+00,  6.87400000e+01, -2.42900000e-01, -9.40000000e-03,
        2.33500000e-01,  9.29304000e+02,  1.26493000e-01,  2.60920000e+01,
       -4.37806287e+02, -4.37799843e+02, -4.37798899e+02, -4.37837025e+02]), array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])), (array([ 4.92930000e+00,  7.09100000e+01, -1.99200000e-01, -2.50000000e-02,
        1.74300000e-01,  1.06849570e+03,  1.03158000e-01,  2.92830000e+01,
       -4.70081061e+02, -4.70073397e+02, -4.70072453e+02, -4.70113072e+02]), array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])), (array([ 1.93840000e+00,  7.22900000e+01, -2.40600000e-01,  9.35000000e-02,
        3.34100000e-01,  8.22189000e+02,  1.52933000e-01,  2.47460000e+01,
       -4.01944215e+02, -4.01938591e+02, -4.01937647e+02, -4.01973852e+02]), array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])), (array([ 5.06714286e-01,  7.50257143e+01, -2.07814286e-01,  8.42714286e-02,
        2.92114286e-01,  9.27218429e+02,  1.65630143e-01,  2.93787143e+01,
       -4.02603883e+02, -4.02596908e+02, -4.02595964e+02, -4.02634689e+02]), array([7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7])), (array([ 1.99720000e+00,  8.18300000e+01, -2.15000000e-01,  8.90000000e-03,
        2.23900000e-01,  1.16949050e+03,  1.60685000e-01,  2.95760000e+01,
       -3.85827859e+02, -3.85820513e+02, -3.85819568e+02, -3.85859969e+02]), array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])), (array([ 2.97674286e+00,  7.03057143e+01, -2.59271429e-01,  2.23285714e-02,
        2.81628571e-01,  1.01687567e+03,  1.41121286e-01,  2.89358571e+01,
       -4.38610121e+02, -4.38602495e+02, -4.38601551e+02, -4.38642571e+02]), array([7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7]))]
Total size = 133,885 | train size = 107,108 | val size = 13,388 | test size = 13,389
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=133, out_features=300, bias=False)
      (W_h): Linear(in_features=314, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
      (gather_op1): Sequential(
        (0): Linear(in_features=433, out_features=300, bias=True)
        (1): Dropout(p=0.0, inplace=False)
        (2): Sigmoid()
      )
      (gather_op2): Sequential(
        (0): Linear(in_features=433, out_features=300, bias=True)
        (1): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=12, bias=True)
  )
)
Number of parameters = 618,612
Moving model to cuda
Epoch 0
Loss = 7.4784e+01, PNorm = 43.3794, GNorm = 91803.5742, lr_0 = 1.0210e-04
Loss = 8.2372e+00, PNorm = 43.3791, GNorm = 39208.0449, lr_0 = 1.0420e-04
Loss = 3.7796e+00, PNorm = 43.3785, GNorm = 19574.7361, lr_0 = 1.0630e-04
Loss = 1.7925e+00, PNorm = 43.3783, GNorm = 29136.9467, lr_0 = 1.0840e-04
Loss = 8.8873e-01, PNorm = 43.3782, GNorm = 13256.4167, lr_0 = 1.1050e-04
Loss = 6.2430e-01, PNorm = 43.3780, GNorm = 10255.0529, lr_0 = 1.1261e-04
Loss = 4.0096e-01, PNorm = 43.3779, GNorm = 16010.3541, lr_0 = 1.1471e-04
Loss = 4.3856e-01, PNorm = 43.3779, GNorm = 14380.0325, lr_0 = 1.1681e-04
Fold 0
{'activation': 'ReLU',
 'atom_messages': True,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': True,
 'data_path': 'data/qm9.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': 0,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': True,
 'save_dir': 'checkpoints/qm9_ggnn/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'scaffold_balanced',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 12
Splitting data with seed 0
Total scaffolds = 15,989 | train scaffolds = 13,406 | val scaffolds = 1,626 | test scaffolds = 957
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([ 3.06770674e+00,  7.52033183e+01, -2.55926597e-01, -5.90761537e-03,
        2.50018624e-01,  1.52537269e+03,  1.51277474e-01,  3.52361516e+01,
       -4.16967530e+02, -4.16957378e+02, -4.16956434e+02, -4.17003691e+02]), array([13998, 13998, 13998, 13998, 13998, 13998, 13998, 13998, 13998,
       13998, 13998, 13998])), (array([ 2.33190000e+00,  7.53500000e+01, -2.14400000e-01, -1.70000000e-02,
        1.97400000e-01,  1.10743790e+03,  1.62372000e-01,  3.06960000e+01,
       -4.19191774e+02, -4.19183938e+02, -4.19182994e+02, -4.19224242e+02]), array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])), (array([ 1.18850000e+00,  6.82200000e+01, -2.56400000e-01, -1.67000000e-02,
        2.39700000e-01,  1.11738480e+03,  1.24501000e-01,  2.86110000e+01,
       -4.74958657e+02, -4.74951049e+02, -4.74950105e+02, -4.74991316e+02]), array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])), (array([ 5.00000000e-04,  8.44500000e+01, -2.18100000e-01,  8.30000000e-03,
        2.26400000e-01,  1.05648860e+03,  1.60839000e-01,  2.87300000e+01,
       -3.48675405e+02, -3.48668704e+02, -3.48667760e+02, -3.48706071e+02]), array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])), (array([ 4.80930000e+00,  6.87400000e+01, -2.42900000e-01, -9.40000000e-03,
        2.33500000e-01,  9.29304000e+02,  1.26493000e-01,  2.60920000e+01,
       -4.37806287e+02, -4.37799843e+02, -4.37798899e+02, -4.37837025e+02]), array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])), (array([ 4.92930000e+00,  7.09100000e+01, -1.99200000e-01, -2.50000000e-02,
        1.74300000e-01,  1.06849570e+03,  1.03158000e-01,  2.92830000e+01,
       -4.70081061e+02, -4.70073397e+02, -4.70072453e+02, -4.70113072e+02]), array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])), (array([ 1.93840000e+00,  7.22900000e+01, -2.40600000e-01,  9.35000000e-02,
        3.34100000e-01,  8.22189000e+02,  1.52933000e-01,  2.47460000e+01,
       -4.01944215e+02, -4.01938591e+02, -4.01937647e+02, -4.01973852e+02]), array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])), (array([ 5.06714286e-01,  7.50257143e+01, -2.07814286e-01,  8.42714286e-02,
        2.92114286e-01,  9.27218429e+02,  1.65630143e-01,  2.93787143e+01,
       -4.02603883e+02, -4.02596908e+02, -4.02595964e+02, -4.02634689e+02]), array([7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7])), (array([ 1.99720000e+00,  8.18300000e+01, -2.15000000e-01,  8.90000000e-03,
        2.23900000e-01,  1.16949050e+03,  1.60685000e-01,  2.95760000e+01,
       -3.85827859e+02, -3.85820513e+02, -3.85819568e+02, -3.85859969e+02]), array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])), (array([ 2.97674286e+00,  7.03057143e+01, -2.59271429e-01,  2.23285714e-02,
        2.81628571e-01,  1.01687567e+03,  1.41121286e-01,  2.89358571e+01,
       -4.38610121e+02, -4.38602495e+02, -4.38601551e+02, -4.38642571e+02]), array([7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7]))]
Total size = 133,885 | train size = 107,108 | val size = 13,388 | test size = 13,389
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=133, out_features=300, bias=False)
      (W_h): Linear(in_features=314, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
      (gather_op1): Sequential(
        (0): Linear(in_features=433, out_features=300, bias=True)
        (1): Dropout(p=0.0, inplace=False)
        (2): Sigmoid()
      )
      (gather_op2): Sequential(
        (0): Linear(in_features=433, out_features=300, bias=True)
        (1): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=12, bias=True)
  )
)
Number of parameters = 618,612
Moving model to cuda
